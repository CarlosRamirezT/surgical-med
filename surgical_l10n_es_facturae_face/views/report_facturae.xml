<?xml version="1.0" encoding="UTF-8"?>
<odoo>

    <template id="template_facturae_surgical" inherit_id="l10n_es_facturae.template_facturae">
        <xpath
            expr="//Invoices/Invoice/InvoiceIssueData/t/ReceiverTransactionReference"
            position="replace">
            <ReceiverTransactionReference
                t-esc="move.facturae_receiver_transaction_reference or move.ref"
                t-length="20"
                t-if="move.facturae_receiver_transaction_reference or move.ref"
            />
        </xpath>
        <xpath
            expr="//Invoices/Invoice/Items/InvoiceLine/ReceiverTransactionReference"
            position="replace">
            <ReceiverTransactionReference
                t-length="20"
                t-if="line.facturae_receiver_transaction_reference or move.facturae_receiver_transaction_reference or move.ref"
                t-out="line.facturae_receiver_transaction_reference or move.facturae_receiver_transaction_reference or move.ref"
            />
        </xpath>
        <xpath expr="//Invoices/Invoice/Items/InvoiceLine/DeliveryNotesReferences" position="replace">
        <t t-set="line_picking_name" t-value="line._get_invoice_stock_picking_names()"/>
            <DeliveryNotesReferences t-if="line_picking_name" t-esc="line_picking_name"/>
        </xpath>
    </template>

</odoo>